<% 
const title = 'Admin Dashboard';
const body = `
<div class="dashboard">
    <div class="dashboard-header">
        <h1>Admin Dashboard</h1>
        <p>Current Quarter: ${currentQuarter}</p>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-content">
                <h3>${totalEmployees}</h3>
                <p>Total Employees</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-user-tie"></i>
            </div>
            <div class="stat-content">
                <h3>${totalHODs}</h3>
                <p>Total HODs</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-building"></i>
            </div>
            <div class="stat-content">
                <h3>${totalDepartments}</h3>
                <p>Departments</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-question-circle"></i>
            </div>
            <div class="stat-content">
                <h3>${totalQuestions}</h3>
                <p>Review Questions</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-star"></i>
            </div>
            <div class="stat-content">
                <h3>${avgRating}</h3>
                <p>Avg Rating (${currentQuarter})</p>
            </div>
        </div>
    </div>
    
    <div class="dashboard-grid">
        <div class="dashboard-card">
            <h3>Department Performance (${currentQuarter})</h3>
            <div class="department-stats">
                ${departmentStats.map(dept => `
                    <div class="dept-stat">
                        <span class="dept-name">${dept._id}</span>
                        <span class="dept-rating">${dept.avgRating.toFixed(2)} ⭐</span>
                        <span class="dept-count">(${dept.reviewCount} employees)</span>
                    </div>
                `).join('')}
                ${departmentStats.length === 0 ? '<p>No reviews yet for current quarter</p>' : ''}
            </div>
        </div>
        
        <div class="dashboard-card">
            <h3>Quarterly Trends</h3>
            <div class="trends-chart">
                ${quarterlyTrends.map(trend => `
                    <div class="trend-item">
                        <span class="trend-quarter">${trend.quarter}</span>
                        <span class="trend-rating">${trend.avgRating} ⭐</span>
                        <span class="trend-count">(${trend.reviewCount} reviews)</span>
                    </div>
                `).join('')}
            </div>
        </div>
    </div>
    
    <div class="admin-actions">
        <a href="/admin/questions" class="btn btn-primary">
            <i class="fas fa-question-circle"></i> Manage Questions
        </a>
        <a href="/admin/departments" class="btn btn-primary">
            <i class="fas fa-building"></i> Manage Departments
        </a>
        <a href="/admin/employees" class="btn btn-primary">
            <i class="fas fa-users"></i> Manage Employees
        </a>
        <div class="export-section" style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #eee;">
            <h4 style="margin-bottom: 1rem; color: #2c3e50;">Export Data</h4>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <a href="/admin/export/reviews" class="btn btn-outline">
                    <i class="fas fa-download"></i> Export All Reviews
                </a>
                <a href="/admin/export/performance" class="btn btn-outline">
                    <i class="fas fa-chart-bar"></i> Export Performance Summary
                </a>
                <a href="/admin/export/reviews?quarter=${currentQuarter}" class="btn btn-outline">
                    <i class="fas fa-calendar"></i> Export Current Quarter
                </a>
            </div>
        </div>
    </div>
</div>
`;
%>

<%- include('../layout', { title, body, user }) %>
