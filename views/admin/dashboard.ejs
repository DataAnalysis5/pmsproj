<% 
const title = 'Admin Dashboard';
const body = `
<div class="dashboard">
    <div class="dashboard-header">
        <h1>Admin Dashboard</h1>
        <!-- Updated to display current month instead of current quarter -->
        <p>Current Month: ${currentMonth}</p>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-content">
                <h3>${totalEmployees}</h3>
                <p>Total Employees</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-user-tie"></i>
            </div>
            <div class="stat-content">
                <h3>${totalHODs}</h3>
                <p>Total HODs</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-building"></i>
            </div>
            <div class="stat-content">
                <h3>${totalDepartments}</h3>
                <p>Departments</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-question-circle"></i>
            </div>
            <div class="stat-content">
                <h3>${totalQuestions}</h3>
                <p>Review Questions</p>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-star"></i>
            </div>
            <div class="stat-content">
                <h3>${avgRating}</h3>
                <!-- Updated from quarter to month -->
                <p>Avg Rating (${currentMonth})</p>
            </div>
        </div>
    </div>
    
    <div class="dashboard-grid">
        <div class="dashboard-card">
            <!-- Updated from quarterly to monthly reference -->
            <h3>Department Performance (${currentMonth})</h3>
            <div class="department-stats">
                ${departmentStats.map(dept => `
                    <div class="dept-stat">
                        <span class="dept-name">${dept._id}</span>
                        <span class="dept-rating">${dept.avgRating.toFixed(2)} ⭐</span>
                        <span class="dept-count">(${dept.reviewCount} employees)</span>
                    </div>
                `).join('')}
                ${departmentStats.length === 0 ? '<p>No reviews yet for current month</p>' : ''}
            </div>
        </div>
        
        <div class="dashboard-card">
            <!-- Updated header from Quarterly Trends to Monthly Trends -->
            <h3>Monthly Trends (Last 12 Months)</h3>
            <div class="trends-chart">
                <!-- Updated from quarterlyTrends to monthlyTrends -->
                ${monthlyTrends.map(trend => `
                    <div class="trend-item">
                        <span class="trend-month">${trend.month}</span>
                        <span class="trend-rating">${trend.avgRating} ⭐</span>
                        <span class="trend-count">(${trend.reviewCount} reviews)</span>
                    </div>
                `).join('')}
            </div>
        </div>
    </div>
    
    <div class="admin-actions">
        <a href="/admin/questions" class="btn btn-primary">
            <i class="fas fa-question-circle"></i> Manage Questions
        </a>
        <a href="/admin/departments" class="btn btn-primary">
            <i class="fas fa-building"></i> Manage Departments
        </a>
        <a href="/admin/employees" class="btn btn-primary">
            <i class="fas fa-users"></i> Manage Employees
        </a>
        <div class="export-section" style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #eee;">
            <h4 style="margin-bottom: 1rem; color: #2c3e50;">Export Data</h4>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <a href="/admin/export/reviews" class="btn btn-outline">
                    <i class="fas fa-download"></i> Export All Reviews
                </a>
                <a href="/admin/export/performance" class="btn btn-outline">
                    <i class="fas fa-chart-bar"></i> Export Performance Summary
                </a>
                <!-- Updated quarter reference to month -->
                <a href="/admin/export/reviews?month=${currentMonth}" class="btn btn-outline">
                    <i class="fas fa-calendar"></i> Export Current Month
                </a>
            </div>
        </div>
    </div>
</div>
`;
%>

<%- include('../layout', { title, body, user }) %>
